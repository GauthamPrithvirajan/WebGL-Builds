<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Unity Web Player | PoC Car Configurator alpha01</title>
    <link rel="shortcut icon" href="TemplateData/favicon.ico">
    <link rel="stylesheet" href="TemplateData/style.css">

  </head>
  <body>
    <div id="unity-container" class="unity-desktop">
    <div id="navbar">
    <svg xmlns="http://www.w3.org/2000/svg" width="120" height="18" style="padding:20px 0px 12px 24px;" viewBox="0 0 264.583 38.666"><path fill="white" d="M68.251 38.023h20.51c1.803 0 3.01-1.327 3.01-3.235v-1.642c-.985.225-2.464.327-5.262.327h-6.75l11.738-22.606H68.42v4.478h10.326l-9.84 18.677c-.875 1.641-.979 2.956-.655 4M47.805 23.587l5.314 10.222c1.482 2.945 2.14 4.214 5.488 4.214h7.565c-.435-.341-.827-1.047-1.593-2.41l-7.737-14.226 9.054-10.52h-8.058zm-9.927 14.436h9.378V5.556C47.256 2.188 44.787 0 41.39 0h-3.513zm-4.163-2.463L24.344 7.697c-1.1-3.33-2.249-4.857-6.855-4.857h-4.446L0 38.025h5.916l2.976-8.701h12.562l1.79 5.628c.66 2.077 1.48 2.998 3.73 2.998h7.896c-.382-.38-.66-1.025-1.155-2.39M10.357 25.063l5.041-14.721 4.7 14.721zm97.266 13.603c7.785 0 14.414-5.566 14.414-14.796 0-7.872-6.298-13.708-14.25-13.708-7.896 0-14.484 5.727-14.484 14.967.002 8.126 6.59 13.537 14.32 13.537m.104-5.017c-3.175 0-4.328-3.667-4.328-9.4 0-5.459 1.1-9.18 4.328-9.18 3.186 0 4.221 3.934 4.221 9.666 0 5.42-1.032 8.914-4.221 8.914m18.527 4.374h5.862V15.589l14.903 17.893c2.086 2.522 3.457 4.54 5.706 4.54h4.27V5.79c0-1.859-1.255-3.053-3.173-3.053h-2.58v21.215L136.914 6.876c-2.137-2.558-3.232-4.14-6.351-4.14h-4.308zm49.115.643c7.787 0 14.423-5.566 14.423-14.796 0-7.86-6.31-13.708-14.257-13.708-7.898 0-14.472 5.727-14.472 14.967-.002 8.133 6.574 13.537 14.306 13.537m.11-5.017c-3.183 0-4.334-3.667-4.334-9.397 0-5.462 1.098-9.183 4.335-9.183 3.174 0 4.219 3.944 4.219 9.676 0 5.41-1.045 8.904-4.22 8.904m75.66-8.694a21 21 0 0 0 .222-3.162c0-6.448-4.77-11.58-12.937-11.58-8.111 0-14.04 5.676-14.04 14.312 0 8.355 5.208 14.14 13.704 14.14 8.503 0 11.564-4.419 11.74-8.683-1.818 1.32-4.608 2.076-7.736 2.076-4.749 0-7.82-2.7-8.264-7.103zm-17.313-3.76c.304-3.99 1.847-6.503 4.482-6.503 3.622 0 4.333 6.504 4.333 6.504zm-23.529-10.707c-3.182 0-5.815 1.148-7.135 2.459V5.573c0-3.383-2.41-5.57-5.805-5.57h-3.508v38.022h10.965c10.468 0 16.28-5.469 16.28-15.632 0-6.828-4.654-11.905-10.797-11.905m-5.71 22.994h-1.425v-17.53c.605-.063 1.103-.116 2.034-.116 3.568 0 6.256 3.285 6.256 7.65 0 6.496-2.475 9.996-6.866 9.996zm50.676 4.541h9.32V5.57c0-3.382-2.468-5.57-5.867-5.57h-3.455v38.023z"></path></svg>
    </div>
    <div id="sidePanel">
    <h1 style="width:100%;">Select a colour</h1>
    </div>
      <canvas id="unity-canvas" width=1920 height=1080 tabindex="-1"></canvas>
      <div id="tooltip" class="tooltipText"></div>
      <div id="unity-loading-bar">
        <div id="unity-logo"></div>
        <div id="unity-progress-bar-empty">
          <div id="unity-progress-bar-full"></div>
        </div>
      </div>
      <div id="unity-warning"> </div>
     <div id="unity-footer">
        <div id="unity-logo-title-footer"></div>
        <div id="unity-fullscreen-button"></div>
        <div id="unity-build-title">PoC Car Configurator alpha01</div>
      </div>
    </div>
     <script type="text/javascript" src="colors.json"></script>
 <script  type="module">
               //import jsonData from './colorsNew.json' assert { type: 'json' };
     //   console.log(jsonData);
     fetch('./colors.json')
  .then(response => response.json())
  .then(data => {
            const dataDisplay = document.getElementById("sidePanel");
            for (let i = 1; i < data.length; i++) {
            // Create HTML elements to display the JSON data
               /* const nameElement = document.createElement("div");
                nameElement.style.backgroundColor = data[i].hex;
                nameElement.className += "swatch";
                nameElement.onclick = callUnityInstance(data[i].rgb);
               //console.log(data[i].rgb[2]);

                const tooltipElement = document.createElement("div");
                tooltipElement.textContent = data[i].name;
                tooltipElement.className += "tooltipText";

               //console.log(data[i].hex);
                // Append the elements to the "dataDisplay" div
                nameElement.appendChild(tooltipElement);
                dataDisplay.appendChild(nameElement);*/

                dataDisplay.innerHTML += "<div class='swatch' onmouseenter='showTooltip("+'"'+ data[i].name + '"' +")' onmouseleave='hideTooltip()' style='background:"+  data[i].hex +"'onclick='callUnityInstance(" + data[i].rgb + ")'></div>";
            }

        })
  .catch(error => console.log(error));
        </script>
    <script>
      var canvas = document.querySelector("#unity-canvas");

      // Shows a temporary message banner/ribbon for a few seconds, or
      // a permanent error message on top of the canvas if type=='error'.
      // If type=='warning', a yellow highlight color is used.
      // Modify or remove this function to customize the visually presented
      // way that non-critical warnings and error messages are presented to the
      // user.
      function unityShowBanner(msg, type) {
        var warningBanner = document.querySelector("#unity-warning");
        function updateBannerVisibility() {
          warningBanner.style.display = warningBanner.children.length ? 'block' : 'none';
        }
        var div = document.createElement('div');
        div.innerHTML = msg;
        warningBanner.appendChild(div);
        if (type == 'error') div.style = 'background: red; padding: 10px;';
        else {
          if (type == 'warning') div.style = 'background: yellow; padding: 10px;';
          setTimeout(function() {
            warningBanner.removeChild(div);
            updateBannerVisibility();
          }, 5000);
        }
        updateBannerVisibility();
      }

      var buildUrl = "Build";
      var loaderUrl = buildUrl + "/WebGL Builds.loader.js";
      var config = {
        arguments: [],
        dataUrl: buildUrl + "/WebGL Builds.data.br",
        frameworkUrl: buildUrl + "/WebGL Builds.framework.js.br",
        codeUrl: buildUrl + "/WebGL Builds.wasm.br",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "DefaultCompany",
        productName: "PoC Car Configurator alpha01",
        productVersion: "0.1.0",
        showBanner: unityShowBanner,
      };

      // By default, Unity keeps WebGL canvas render target size matched with
      // the DOM size of the canvas element (scaled by window.devicePixelRatio)
      // Set this to false if you want to decouple this synchronization from
      // happening inside the engine, and you would instead like to size up
      // the canvas DOM size and WebGL render target sizes yourself.
      // config.matchWebGLToCanvasSize = false;

      // If you would like all file writes inside Unity Application.persistentDataPath
      // directory to automatically persist so that the contents are remembered when
      // the user revisits the site the next time, uncomment the following line:
      // config.autoSyncPersistentDataPath = true;
      // This autosyncing is currently not the default behavior to avoid regressing
      // existing user projects that might rely on the earlier manual
      // JS_FileSystem_Sync() behavior, but in future Unity version, this will be
      // expected to change.

      if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        // Mobile device style: fill the whole browser client area with the game canvas:

        var meta = document.createElement('meta');
        meta.name = 'viewport';
        meta.content = 'width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes';
        document.getElementsByTagName('head')[0].appendChild(meta);
        document.querySelector("#unity-container").className = "unity-mobile";
        canvas.className = "unity-mobile";

        // To lower canvas resolution on mobile devices to gain some
        // performance, uncomment the following line:
        // config.devicePixelRatio = 1;


      } else {
        // Desktop style: Render the game canvas in a window that can be maximized to fullscreen:
        canvas.style.width = "70%";
        canvas.style.height = "calc(100% - 60px)";
      }

      document.querySelector("#unity-loading-bar").style.display = "block";

      var script = document.createElement("script");
      var MyGameInstance = null;

      script.src = loaderUrl;
      script.onload = () => {
        createUnityInstance(canvas, config, (progress) => {
            
          document.querySelector("#unity-progress-bar-full").style.width = 100 * progress + "%";
              }).then((unityInstance) => {
                  MyGameInstance = unityInstance;
                document.querySelector("#unity-loading-bar").style.display = "none";
                document.querySelector("#unity-fullscreen-button").onclick = () => {
                  unityInstance.SetFullscreen(1);
                };

     

              }).catch((message) => {
                alert(message);
              });
            };

      document.body.appendChild(script);

      function callUnityInstance(r,g,b){
         // console.log(r + "  " + g + " " + b);
          const str= new Array(r+"+"+g+"+"+b+"");
          MyGameInstance.SendMessage('JavascriptObject','testJson',str.toString());
      }

      function showTooltip(str){
        //console.log(str);
        const dataDisplay = document.getElementById("unity-container");
        const tooltip = document.getElementById("tooltip");

        tooltip.innerHTML=str;

        dataDisplay.appendChild(tooltip);

        document.body.onpointermove = event => {
        const { clientX, clientY } = event;

        tooltip.animate({
        left: `${clientX + 12}px`,
        top: `${clientY - 24 }px`
    
        }, {duration: 1000, fill: "forwards"})

        }
        
        tooltip.style.display = "block";
        tooltip.style.zIndex= 10;
      }

      function hideTooltip(){
        const tooltip = document.getElementById("tooltip");
        tooltip.style.display = "none";
      }

    </script>
  </body>
</html>
